# κΈμ† 3D ν”„λ¦°ν… κ²°ν•¨ κ²€μ¶ λ° λ¶„λ¥ ν”„λ΅μ νΈ

## π“‹ ν”„λ΅μ νΈ κ°μ”

κΈμ† 3D ν”„λ¦°ν… κ³µμ • μ¤‘ λ°μƒν•λ” κ²°ν•¨μ„ **AprilGAN + CNN** κµ¬μ΅°λ¥Ό ν™μ©ν•μ—¬ κ²€μ¶ν•κ³  λ¶„λ¥ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤.
**μ „μ²΄ μ‹μ¤ν…μ€ μ—°ν•©ν•™μµ(Federated Learning) ν”„λ μ„μ›ν¬ λ‚΄μ—μ„ λ™μ‘**ν•λ©°, κΈ°μ—… κ°„ λ°μ΄ν„° κ³µμ  μ—†μ΄ λ¨λΈ μ„±λ¥μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.

## π€ μ‹μ‘ν•κΈ°

### ν•„μ μ”κµ¬μ‚¬ν•­

- **Python**: 3.8 μ΄μƒ (κ¶μ¥: 3.9 μ΄μƒ)
- **pip**: Python ν¨ν‚¤μ§€ κ΄€λ¦¬μ
- **NVIDIA GPU**: CUDAλ¥Ό μ§€μ›ν•λ” NVIDIA GPU
- **CUDA Toolkit**: GPU κ°€μ†μ„ μ„ν• CUDA Toolkit (ν•„μ: CUDA 12.8)

### μ„¤μΉ λ°©λ²•

μμ„Έν• μ„¤μΉ κ°€μ΄λ“λ” [INSTALLATION.md](INSTALLATION.md)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

1. **CUDA Toolkit 12.8 μ„¤μΉ** (ν•„μ)
   - [NVIDIA CUDA Toolkit λ‹¤μ΄λ΅λ“](https://developer.nvidia.com/cuda-downloads)
   - ν•„μ λ²„μ „: CUDA 12.8

2. **κ°€μƒ ν™κ²½ μƒμ„± λ° ν™μ„±ν™”**
   ```powershell
   python -m venv venv
   .\venv\Scripts\Activate.ps1
   ```

3. **ν¨ν‚¤μ§€ μ„¤μΉ**
   ```powershell
   pip install -r requirements.txt
   ```

4. **PyTorch CUDA 12.8 λ²„μ „ μ„¤μΉ**
   ```powershell
   # CUDA 12.8 μ§μ ‘ μ§€μ› λ²„μ „
   pip install torch torchvision --index-url https://download.pytorch.org/whl/cu128
   ```

5. **ν™κ²½ λ³€μ μ„¤μ •**
   - ν”„λ΅μ νΈ λ£¨νΈμ— `.env` νμΌ μƒμ„±
   - MongoDB μ—°κ²° μ •λ³΄ μ…λ ¥ (μμ„Έν• λ‚΄μ©μ€ [INSTALLATION.md](INSTALLATION.md) μ°Έκ³ )

μμ„Έν• μ„¤μΉ κ°€μ΄λ“λ” [INSTALLATION.md](INSTALLATION.md)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

## π― λ©ν‘

- **κ²°ν•¨ κ²€μ¶**: AprilGANμ„ ν†µν• ν•©μ„± λ°μ΄ν„° μƒμ„± λ° κ²°ν•¨ νƒμ§€
- **κ²°ν•¨ λ¶„λ¥**: CNNμ„ ν†µν• κ²°ν•¨ ν΄λμ¤ λ¶„λ¥
- μ ν•λ λ°μ΄ν„° ν™κ²½μ—μ„μ μ„±λ¥ κ°μ„  λ° μ‹¤μ©μ„± ν™•λ³΄
- **μ—°ν•©ν•™μµ**: κΈ°μ—… κ°„ λ°μ΄ν„° κ³µμ  μ—†μ΄ ν‘λ ¥ ν•™μµ

## π—οΈ λ¨λΈ κµ¬μ΅°

### μ—°ν•©ν•™μµ κΈ°λ° AprilGAN + CNN νμ΄ν”„λΌμΈ

```
[ν΄λΌμ΄μ–ΈνΈ 1]                    [ν΄λΌμ΄μ–ΈνΈ 2]                    [ν΄λΌμ΄μ–ΈνΈ N]
(μ£Όλ΅ κ²°ν•¨A)                    (μ£Όλ΅ κ²°ν•¨B)                    (μ£Όλ΅ κ²°ν•¨C)
    β†“                                 β†“                                 β†“
Non-IID λ°μ΄ν„° ν•™μµ          Non-IID λ°μ΄ν„° ν•™μµ          Non-IID λ°μ΄ν„° ν•™μµ
    β†“                                 β†“                                 β†“
κ°€μ¤‘μΉ μ „μ†΅ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β†’ [μ„λ²„]
                                                          β†“
                                                    κ°€μ¤‘μΉ ν‰κ·  κ³„μ‚°
                                                    (Federated Averaging)
                                                          β†“
κ°€μ¤‘μΉ μμ‹  β†β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€
    β†“
ν‰κ· ν™”λ κ°€μ¤‘μΉλ΅ λ¨λΈ μ—…λ°μ΄νΈ
```

**Non-IID ν™κ²½:**
- κ° ν΄λΌμ΄μ–ΈνΈλ” μ„λ΅ λ‹¤λ¥Έ κ²°ν•¨ μ ν• λ¶„ν¬λ¥Ό κ°€μ§
- μ‹¤μ  μ‚°μ—… ν™κ²½μ„ μ •ν™•ν λ°μ
- Federated Averagingμ„ ν†µν•΄ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ μ§€μ‹μ„ ν†µν•©

### AprilGAN + CNN νμ΄ν”„λΌμΈ

```
μ›λ³Έ μ΄λ―Έμ§€
    β†“
[AprilGAN] μ λ΅μƒ· μ΄μƒ νƒμ§€ (ν•™μµ λ¶ν•„μ”)
    β†“
μ΄μƒ μμ—­ λ§μ¤ν¬/μΆν‘ (μ–΄λ””μ— μ΄μƒμ΄ μλ”μ§€)
    β†“
[CNN] κ²°ν•¨ μ ν• λ¶„λ¥ (μ—°ν•©ν•™μµ)
    β†“
κ²°ν•¨ μ ν• ("Super Elevation", "Crack", etc.)
```

- **AprilGAN**: μ λ΅μƒ· λΉ„μ „ μ΄μƒνƒμ§€ λ¨λΈ - μ¶”κ°€ ν•™μµ μ—†μ΄ λ°”λ΅ μ‚¬μ© κ°€λ¥
- **CNN**: κ²°ν•¨ μ ν•λ³„ λ¶„λ¥ μ„±λ¥ κ·Ήλ€ν™” - μ—°ν•©ν•™μµμΌλ΅ ν‘λ ¥ ν•™μµ

### ν•µμ‹¬ μ›μΉ™ (Critical Requirements)

**β οΈ λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ λ³΄μ¥**
- β… **λ°μ΄ν„°λ” μ λ€ κ³µμ ν•μ§€ μ•μ**: κ° ν΄λΌμ΄μ–ΈνΈ(κΈ°μ—…)μ κΈμ† κ³µμ • κ²°ν•¨ λ°μ΄ν„°λ” λ΅μ»¬μ—μ„λ§ μ‚¬μ©
- β… **κ°€μ¤‘μΉλ§ μ „μ†΅**: ν•™μµλ λ¨λΈμ κ°€μ¤‘μΉ(weights)λ§ μ„λ²„λ΅ μ „μ†΅
- β… **μ„λ²„μ—μ„ ν‰κ· ν™”**: μ„λ²„λ” μμ‹ ν• κ°€μ¤‘μΉλ“¤μ ν‰κ· κ°’μ„ κ³„μ‚° (Federated Averaging)
- β… **ν‰κ·  κ°€μ¤‘μΉ λ°°ν¬**: κ³„μ‚°λ ν‰κ·  κ°€μ¤‘μΉλ¥Ό λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ— λ°°ν¬


## π”’ λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ μ¤‘μ‹¬ ν•™μµ μ „λµ ν•µμ‹¬ μ”μ•½

λ³Έ ν”„λ΅μ νΈλ” κΈμ† 3D ν”„λ¦°ν… κ²°ν•¨ κ²€μ¶ ν™κ²½μ—μ„ λ°μƒν•λ” **λ°μ΄ν„° λ¶€μ΅± λ¬Έμ **μ™€  
μ—¬λ¬ κΈ°κ΄€Β·ν΄λΌμ΄μ–ΈνΈ κ°„μ **λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ μ”κµ¬μ‚¬ν•­**μ„ λ™μ‹μ— ν•΄κ²°ν•κΈ° μ„ν•  
ν”„λΌμ΄λ²„μ‹ μ¤‘μ‹¬ ν•™μµ μ „λµμ„ κΈ°λ°μΌλ΅ ν•©λ‹λ‹¤.

### π“ ν•µμ‹¬ μ›μΉ™

- **GANμ€ ν΄λΌμ΄μ–ΈνΈ λ‚΄λ¶€(Local)μ—μ„λ§ ν•™μµ**ν•μ—¬ λ―Όκ° λ°μ΄ν„°κ°€ μ™Έλ¶€λ΅ μ μ¶λμ§€ μ•μµλ‹λ‹¤.
- **GANμ΄ μƒμ„±ν• ν•©μ„± λ°μ΄ν„° λν• κ³µμ λμ§€ μ•μΌλ©°**, μ¤μ§ λ΅μ»¬ ν•™μµμ—λ§ μ‚¬μ©λ©λ‹λ‹¤.
- **CNN λ¶„λ¥ λ¨λΈμ€ Federated Learning(FedAvg) λ°©μ‹μΌλ΅ ν†µν•© ν•™μµ**λ©λ‹λ‹¤.
- μ¤‘μ•™ μ„λ²„λ” **μ΄λ―Έμ§€κ°€ μ•„λ‹, λ¨λΈμ κ°€μ¤‘μΉ λ³€ν™”(Ξ”W)λ§ μμ‹ **ν•©λ‹λ‹¤.
- λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ **μ›λ³Έ λ°μ΄ν„°λ” μ λ€ μ„λ²„λ΅ μ „λ‹¬λμ§€ μ•μµλ‹λ‹¤.**
- Federated Learningμ€ **λ„¤νΈμ›ν¬ κµ¬μ΅°(CNN, U-Net, GAN)μ— λ…λ¦½μ **μ΄λ―€λ΅ λ‹¤μ–‘ν• λ¨λΈ μ μ©μ΄ κ°€λ¥ν•©λ‹λ‹¤.
- μ „μ²΄ κ³Όμ •μ€ μ•„λμ **νμ΄ν”„λΌμΈ μ΄λ―Έμ§€**λ¥Ό ν†µν•΄ μ‹κ°μ μΌλ΅ μ •λ¦¬λ©λ‹λ‹¤.
- μ΄λ¬ν• μ΅°ν•©μ€ **λ°μ΄ν„° λ¶€μ΅± + ν”„λΌμ΄λ²„μ‹ λ³΄νΈ + κ²°ν•¨ κ²€μ¶ μ„±λ¥ ν–¥μƒ**μ„ λ™μ‹μ— λ‹¬μ„±ν•κΈ° μ„ν• μµμ μ κµ¬μ΅°μ…λ‹λ‹¤.

### κµ¬μ΅° λ³€κ²½ μ΄μ 

1. **λ°μ΄ν„° μ μ•½**: μ ν•λ μ‹¤μ  λ°μ΄ν„°μ…‹μΌλ΅ μΈν• U-Net κΈ°λ° λ¶„ν•  λ¨λΈμ ν•κ³„
2. **ν¨μ¨μ„±**: λ¶„λ¥ μ¤‘μ‹¬ κ³Όμ μ— μ ν•©ν• κµ¬μ΅°λ΅ μ¬μ„¤κ³„
3. **ν™•μ¥μ„±**: GAN κΈ°λ° λ°μ΄ν„° μ¦κ°•μ„ ν†µν• λ¨λΈ μΌλ°ν™” λ¥λ ¥ ν–¥μƒ
4. **ν”„λΌμ΄λ²„μ‹**: μ—°ν•©ν•™μµμ„ ν†µν• κΈ°μ—… κ°„ λ°μ΄ν„° κ³µμ  μ—†μ΄ ν‘λ ¥ ν•™μµ

## π—‚οΈ ν”„λ΅μ νΈ κµ¬μ΅°

ν”„λ΅μ νΈλ” λ‹¤μκ³Ό κ°™μ΄ κµ¬μ„±λλ©°, **μ „μ²΄κ°€ μ—°ν•©ν•™μµ ν”„λ μ„μ›ν¬ λ‚΄μ—μ„ λ™μ‘**ν•©λ‹λ‹¤:

```
GAN-CNN/
β”β”€β”€ train_federated.py   # μ—°ν•©ν•™μµ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ (λ©”μΈ)
β”β”€β”€ models/              # λ¨λΈ κµ¬ν„
β”‚   β”β”€β”€ aprilgan.py      # AprilGAN μ λ΅μƒ· λ¨λΈ λνΌ
β”‚   β”β”€β”€ cnn.py           # CNN κ²°ν•¨ λ¶„λ¥ λ¨λΈ
β”‚   β””β”€β”€ few_shot_cnn.py  # ν“¨μƒ· ν•™μµ CNN λ¨λΈ
β”β”€β”€ federated/           # μ—°ν•©ν•™μµ ν”„λ μ„μ›ν¬
β”‚   β”β”€β”€ server.py        # μ—°ν•©ν•™μµ μ„λ²„ (κ°€μ¤‘μΉ μ§‘κ³„)
β”‚   β”β”€β”€ client.py        # μ—°ν•©ν•™μµ ν΄λΌμ΄μ–ΈνΈ (λ΅μ»¬ ν•™μµ)
β”‚   β””β”€β”€ aggregator.py    # Federated Averaging μ•κ³ λ¦¬μ¦
β”β”€β”€ utils/               # μ ν‹Έλ¦¬ν‹°
β”‚   β”β”€β”€ data_loader.py   # λ°μ΄ν„° λ΅λ”© λ° μ „μ²λ¦¬
β”‚   β”β”€β”€ client_data_loader.py  # ν΄λΌμ΄μ–ΈνΈλ³„ Non-IID λ°μ΄ν„° λ΅λ”
β”‚   β”β”€β”€ non_iid_distribution.py  # Non-IID λ°μ΄ν„° λ¶„λ°° μ•κ³ λ¦¬μ¦
β”‚   β”β”€β”€ few_shot_dataset.py  # ν“¨μƒ· ν•™μµ λ°μ΄ν„°μ…‹
β”‚   β””β”€β”€ bbox_utils.py    # λ°”μ΄λ”©λ°•μ¤ μ²λ¦¬
β”β”€β”€ demo/                # λ°λ¨ λ° μμ 
β”‚   β””β”€β”€ federated_learning_demo.ipynb  # μ „μ²΄ νμ΄ν”„λΌμΈ μ‹μ—°
β”β”€β”€ data/                # λ°μ΄ν„° λ””λ ‰ν† λ¦¬
β””β”€β”€ utils/dataset/       # λ°μ΄ν„°μ…‹ κ΄€λ¦¬ μ¤ν¬λ¦½νΈ
```

### μ£Όμ” λ¨λ“ μ„¤λ…

1. **λ°μ΄ν„° μ²λ¦¬ (Data Processing)**: λ°μ΄ν„° κ°€μ Έμ¤κΈ° λ° μ „μ²λ¦¬
   - κ° ν΄λΌμ΄μ–ΈνΈλ” μμ²΄ λ°μ΄ν„°λ§ μ²λ¦¬ (λ°μ΄ν„°λ” μ™Έλ¶€λ΅ μ „μ†΅λμ§€ μ•μ)

2. **AprilGAN (Defect Detection)**: μ λ΅μƒ· μ΄μƒ νƒμ§€
   - μ‚¬μ „ ν•™μµλ λ¨λΈλ΅ μ¶”κ°€ ν•™μµ λ¶ν•„μ”
   - λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ—μ„ λ™μΌν• λ¨λΈ μ‚¬μ©
   - μ΄μƒ μμ—­μ„ μλ™μΌλ΅ κ²€μ¶

3. **CNN (Defect Classification)**: κ²°ν•¨ μ ν•λ³„ λ¶„λ¥
   - AprilGANμ΄ μ°Ύμ€ μ΄μƒ μμ—­μ„ μ…λ ¥μΌλ΅ λ°›μ•„ λ¶„λ¥
   - λ΅μ»¬ λ°μ΄ν„°λ΅ ν•™μµ β†’ κ°€μ¤‘μΉλ§ μ„λ²„λ΅ μ „μ†΅

4. **μ—°ν•© ν•™μµ (Federated Learning)**: μ„λ²„-ν΄λΌμ΄μ–ΈνΈ κµ¬μ΅° κµ¬ν„
   - **μ„λ²„ (Server)**:
     - ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° κ°€μ¤‘μΉ μμ‹ 
     - Federated Averaging μ•κ³ λ¦¬μ¦μΌλ΅ κ°€μ¤‘μΉ ν‰κ·  κ³„μ‚°
     - ν‰κ· ν™”λ κ°€μ¤‘μΉλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ°°ν¬
   - **ν΄λΌμ΄μ–ΈνΈ (Client)**:
     - λ΅μ»¬ λ°μ΄ν„°λ΅ λ¨λΈ ν•™μµ (λ°μ΄ν„°λ” μ λ€ μ™Έλ¶€ μ „μ†΅ μ• ν•¨)
     - ν•™μµλ κ°€μ¤‘μΉλ¥Ό μ„λ²„λ΅ μ „μ†΅
     - μ„λ²„λ΅λ¶€ν„° ν‰κ· ν™”λ κ°€μ¤‘μΉ μμ‹  λ° λ¨λΈ μ—…λ°μ΄νΈ

## π” λ¨λΈ μ„¤λ…

### AprilGAN λ¨λΈ

**μ—­ν• **: μ λ΅μƒ· λΉ„μ „ μ΄μƒνƒμ§€ λ¨λΈλ΅, μ΄λ―Έμ§€μ—μ„ μ΄μƒ μμ—­μ„ μλ™μΌλ΅ μ°Ύμ•„λƒ…λ‹λ‹¤.

**μ™ μ‚¬μ©ν–λ‚μ”?**
- κΈμ† 3D ν”„λ¦°ν… κ²°ν•¨ λ°μ΄ν„°κ°€ λ¶€μ΅±ν• μƒν™©μ—μ„, **μ¶”κ°€ ν•™μµ μ—†μ΄ λ°”λ΅ μ‚¬μ©**ν•  μ μλ” μ λ΅μƒ· λ¨λΈμ΄ ν•„μ”ν–μµλ‹λ‹¤
- λ³µμ΅ν• μ „μ²λ¦¬λ‚ λ°μ΄ν„° λΌλ²¨λ§ μ—†μ΄λ„ μ΄μƒ μμ—­μ„ μλ™μΌλ΅ νƒμ§€ν•  μ μμµλ‹λ‹¤
- λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ—μ„ λ™μΌν• λ¨λΈμ„ μ‚¬μ©ν•λ―€λ΅ μ—°ν•©ν•™μµμ΄ ν•„μ” μ—†μµλ‹λ‹¤

**νΉμ§•**:
- μ‚¬μ „ ν•™μµλ λ¨λΈλ΅ μ¶”κ°€ ν•™μµ λ¶ν•„μ”
- μ›λ³Έ μ΄λ―Έμ§€λ¥Ό κ·Έλ€λ΅ μ…λ ¥λ°›μ•„ μ΄μƒ μμ—­ λ§μ¤ν¬μ™€ μΆν‘λ¥Ό μ¶λ ¥
- **λ‹¨μ **: μ΄μƒμ΄ μλ‹¤λ” κ²ƒμ€ μ• μ μμ§€λ§, μ–΄λ–¤ μΆ…λ¥μ κ²°ν•¨μΈμ§€λ” μ• μ μ—†μ

### CNN λ¨λΈ

**μ—­ν• **: AprilGANμ΄ μ°Ύμ€ μ΄μƒ μμ—­μ΄ μ–΄λ–¤ κ²°ν•¨ μ ν•μΈμ§€ λ¶„λ¥ν•©λ‹λ‹¤.

**μ™ μ‚¬μ©ν–λ‚μ”?**
- AprilGANμ€ μ΄μƒ μ λ¬΄λ§ μ•λ ¤μ£Όλ―€λ΅, **κµ¬μ²΄μ μΈ κ²°ν•¨ μ ν•μ„ λ¶„λ¥**ν•λ” λ¨λΈμ΄ ν•„μ”ν–μµλ‹λ‹¤
- ResNet κΈ°λ°μ CNNμ€ μ΄λ―Έμ§€ λ¶„λ¥μ— ν¨κ³Όμ μ΄λ©°, μ—°ν•©ν•™μµμΌλ΅ μ—¬λ¬ κΈ°μ—…μ λ°μ΄ν„°λ¥Ό ν™μ©ν•  μ μμµλ‹λ‹¤
- AprilGANμ΄ μ΄λ―Έ μ΄μƒ μμ—­μ„ μ°Ύμ•„μ£Όλ―€λ΅, CNNμ€ μμν•κ² λ¶„λ¥ μ‘μ—…λ§ μν–‰ν•λ©΄ λ©λ‹λ‹¤

**νΉμ§•**:
- AprilGANμ΄ μ°Ύμ€ μ΄μƒ μμ—­ ν¨μΉλ¥Ό μ…λ ¥μΌλ΅ λ°›μ•„ κ²°ν•¨ μ ν• λ¶„λ¥
- μ—°ν•©ν•™μµμ„ ν†µν•΄ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈμ μ§€μ‹μ„ ν†µν•© ν•™μµ
- κ°€μ¤‘μΉλ§ μ„λ²„λ΅ μ „μ†΅ν•μ—¬ λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ λ³΄μ¥

### λ‘ λ¨λΈμ ν‘λ ¥

```
μ›λ³Έ μ΄λ―Έμ§€
    β†“
[AprilGAN] "μ—¬κΈ°μ— μ΄μƒμ΄ μμ–΄μ”!" (μ„μΉλ§ μ•λ ¤μ¤)
    β†“
μ΄μƒ μμ—­ ν¨μΉ
    β†“
[CNN] "μ΄κ±΄ 'Super Elevation' κ²°ν•¨μ΄μ—μ”!" (μΆ…λ¥λ¥Ό μ•λ ¤μ¤)
```

- **AprilGAN**: "μ–΄λ””μ—" λ¬Έμ κ°€ μλ”μ§€ μ°Ύμ•„λƒ„ (μ λ΅μƒ·, ν•™μµ λ¶ν•„μ”)
- **CNN**: "λ¬΄μ—‡μΈμ§€" λ¶„λ¥ν•¨ (μ—°ν•©ν•™μµμΌλ΅ μ„±λ¥ ν–¥μƒ)

### λ°μ΄ν„° μ „μ²λ¦¬ κ³Όμ •

1. **λ°”μ΄λ”©λ°•μ¤ β†’ λ§μ¤ν¬ λ³€ν™**
   - JSONμ StartPoint/EndPointλ¥Ό μ΄μ§„ λ§μ¤ν¬λ΅ λ³€ν™
   - CNN ν•™μµμ© λ μ΄λΈ”λ΅ μ‚¬μ©

2. **κ²°ν•¨ μ ν• μ¶”μ¶**
   - TagBoxesμ Comment ν•„λ“μ—μ„ κ²°ν•¨ μ ν• μ¶”μ¶
   - CNN λ¶„λ¥ λ¨λΈμ ν΄λμ¤ λ μ΄λΈ”λ΅ μ‚¬μ©

3. **AprilGAN μ΄μƒ νƒμ§€**
   - μ λ΅μƒ· λ¨λΈλ΅ μ΄μƒ μμ—­ μλ™ κ²€μ¶
   - κ²€μ¶λ μμ—­κ³Ό μ‹¤μ  λ μ΄λΈ” λ§¤μΉ­ν•μ—¬ CNN ν•™μµ λ°μ΄ν„° μƒμ„±

## π”„ μ—°ν•©ν•™μµμ—μ„μ λ‘ λ¨λΈ μ²λ¦¬ μ „λµ

### ν†µν•© μ—°ν•©ν•™μµ λ°©μ‹ (κ¶μ¥)

AprilGANκ³Ό CNNμ€ μμ°¨μ  νμ΄ν”„λΌμΈ κµ¬μ΅°μ΄λ―€λ΅, **CNNλ§ μ—°ν•©ν•™μµ**μ„ μν–‰ν•©λ‹λ‹¤.

**ν΄λΌμ΄μ–ΈνΈ μΈ΅ ν”„λ΅μ„Έμ¤:**
1. μ„λ²„λ΅λ¶€ν„° μµμ‹  CNN κ°€μ¤‘μΉ μμ‹ 
2. λ΅μ»¬ μ΄λ―Έμ§€μ— AprilGAN μ μ© (μ λ΅μƒ·, ν•™μµ μ—†μ)
3. AprilGANμ΄ μ°Ύμ€ μ΄μƒ μμ—­ μ¶”μ¶
4. **Non-IID λ°μ΄ν„°**λ΅ CNN λ¶„λ¥ λ¨λΈ ν•™μµ
5. CNN κ°€μ¤‘μΉλ§ μ„λ²„λ΅ μ „μ†΅

**μ„λ²„ μΈ΅ ν”„λ΅μ„Έμ¤:**
1. λ¨λ“  ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° CNN κ°€μ¤‘μΉ μμ‹ 
2. CNN κ°€μ¤‘μΉ ν‰κ· ν™” (Federated Averaging)
   - κ° ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„° ν¬κΈ°μ— λ”°λΌ κ°€μ¤‘μΉ μ΅°μ •
   - Non-IID ν™κ²½μ—μ„λ„ ν¨κ³Όμ μΌλ΅ μ‘λ™
3. ν‰κ· ν™”λ CNN κ°€μ¤‘μΉλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ°°ν¬

**Non-IID ν™κ²½μ λ„μ „κ³Όμ :**
- κ° ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ΅ λ‹¤λ¥Έ κ²°ν•¨ μ ν• λ¶„ν¬λ¥Ό κ°€μ§
- Federated Averagingμ΄ μ΄λ¥Ό κ·Ήλ³µν•μ—¬ λ¨λ“  κ²°ν•¨ μ ν•μ— λ€ν• μ§€μ‹μ„ ν†µν•©
- λ°μ΄ν„° ν¬κΈ° κΈ°λ° κ°€μ¤‘μΉλ΅ κ³µμ •ν• μ§‘κ³„ λ³΄μ¥

**μ¥μ :**
- ν†µμ‹  ν¨μ¨μ„±: CNN κ°€μ¤‘μΉλ§ μ „μ†΅
- λ¨λΈ λ™κΈ°ν™”: λ¨λ“  ν΄λΌμ΄μ–ΈνΈκ°€ λ™μΌν• AprilGAN μ‚¬μ©
- κµ¬ν„ λ‹¨μμ„±: ν•λ‚μ μ—°ν•©ν•™μµ λΌμ΄λ“λ΅ κ΄€λ¦¬
- ν„μ‹¤μ„±: Non-IID ν™κ²½μ„ μ •ν™•ν λ°μ

## π“ λ°μ΄ν„°μ…‹

- κΈμ† 3D ν”„λ¦°ν… κ³µμ • κ²°ν•¨ μ΄λ―Έμ§€
- JSON νμΌμ— λ°”μ΄λ”©λ°•μ¤ ν•νƒλ΅ κ²°ν•¨ μ •λ³΄ μ €μ¥
- κ²°ν•¨ μ ν•λ³„ μƒν” λ¶κ· ν• λ¬Έμ  ν•΄κ²°μ„ μ„ν• AprilGAN κΈ°λ° μ¦κ°•

### Non-IID λ°μ΄ν„° λ¶„λ°°

λ³Έ ν”„λ΅μ νΈλ” **Non-IID (Non-Independent and Identically Distributed)** λ°μ΄ν„° λ¶„λ°°λ¥Ό μ§€μ›ν•©λ‹λ‹¤. μ΄λ” μ‹¤μ  μ—°ν•©ν•™μµ ν™κ²½μ„ μ‹λ®¬λ μ΄μ…ν•κΈ° μ„ν• μ¤‘μ”ν• κΈ°λ¥μ…λ‹λ‹¤.

**Non-IIDλ€?**
- κ° ν΄λΌμ΄μ–ΈνΈ(κΈ°μ—…)κ°€ μ„λ΅ λ‹¤λ¥Έ κ²°ν•¨ μ ν• λ¶„ν¬λ¥Ό κ°€μ§€λ” μƒν™©
- μ: ν΄λΌμ΄μ–ΈνΈ Aλ” μ£Όλ΅ "Super Elevation" κ²°ν•¨, ν΄λΌμ΄μ–ΈνΈ Bλ” μ£Όλ΅ "Crack" κ²°ν•¨
- μ‹¤μ  μ‚°μ—… ν™κ²½μ—μ„ λ§¤μ° ν”ν• μƒν™© (κ° κΈ°μ—…μ κ³µμ • νΉμ„±μ— λ”°λΌ κ²°ν•¨ μ ν•μ΄ λ‹¤λ¦„)

**κµ¬ν„ λ°©μ‹:**
- **Dirichlet λ¶„ν¬** κΈ°λ° λ°μ΄ν„° λ¶„λ°°
- `alpha` νλΌλ―Έν„°λ΅ νΈν–¥ μ •λ„ μ΅°μ  κ°€λ¥:
  - `alpha = 0.1`: λ§¤μ° νΈν–¥ (κ° ν΄λΌμ΄μ–ΈνΈκ°€ νΉμ • κ²°ν•¨ μ ν•μ— μ§‘μ¤‘)
  - `alpha = 0.5`: λ³΄ν†µ νΈν–¥ (ν„μ‹¤μ μΈ Non-IID)
  - `alpha = 1.0`: μ•½κ°„ νΈν–¥
  - `alpha = 10.0`: κ±°μ κ· λ“± (IIDμ— κ°€κΉμ›€)

**μ‚¬μ© μμ‹:**
```python
from utils.client_data_loader import load_client_data

# ν΄λΌμ΄μ–ΈνΈλ³„ Non-IID λ°μ΄ν„° λ΅λ“
train_loaders, val_loaders, defect_type_to_idx = load_client_data(
    data_dir=Path("data"),
    aprilgan_model=aprilgan,
    num_clients=3,
    non_iid_alpha=0.5,  # Non-IID μ •λ„ μ΅°μ 
    train_ratio=0.8,
    batch_size=32
)
```

**Non-IIDμ μ¤‘μ”μ„±:**
- μ‹¤μ  μ—°ν•©ν•™μµ ν™κ²½μ„ μ •ν™•ν μ‹λ®¬λ μ΄μ…
- κ° ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„° λ¶„ν¬ μ°¨μ΄λ΅ μΈν• ν•™μµ λ‚μ΄λ„ μ¦κ°€
- Federated Averagingμ ν¨κ³Όλ¥Ό κ²€μ¦ν•κΈ° μ„ν• ν•„μ μ”μ†

## π“ κΈ°λ€ ν¨κ³Ό

- **λ°μ΄ν„° ν™•μ¥**: GAN κΈ°λ° ν•©μ„± λ°μ΄ν„°λ΅ ν›λ ¨ μ„ΈνΈ λ€ν­ ν™•μ¥
- **μ„±λ¥ κ°μ„ **: CNN λ¶„λ¥ λ¨λΈμ μ •ν™•λ„ ν–¥μƒ
- **λ¶κ· ν• ν•΄μ†**: κ²°ν•¨ μ ν•λ³„ λ°μ΄ν„° λ¶κ· ν• λ¬Έμ  μ™„ν™”
- **ν”„λΌμ΄λ²„μ‹ λ³΄μ¥**: κΈ°μ—… κ°„ λ°μ΄ν„° κ³µμ  μ—†μ΄ ν‘λ ¥ ν•™μµ
- **Non-IID ν™κ²½ λ€μ‘**: μ„λ΅ λ‹¤λ¥Έ λ°μ΄ν„° λ¶„ν¬λ¥Ό κ°€μ§„ ν΄λΌμ΄μ–ΈνΈ κ°„ ν‘λ ¥ ν•™μµ
- **ν„μ‹¤μ  μ‹λ®¬λ μ΄μ…**: μ‹¤μ  μ‚°μ—… ν™κ²½μ„ λ°μν• μ—°ν•©ν•™μµ κ²€μ¦

## π”’ μ—°ν•©ν•™μµ λ³΄μ• λ° ν”„λΌμ΄λ²„μ‹

### λ°μ΄ν„° λ³΄νΈ
- **λ΅μ»¬ ν•™μµ**: λ¨λ“  ν•™μµμ€ ν΄λΌμ΄μ–ΈνΈμ λ΅μ»¬ ν™κ²½μ—μ„ μν–‰
- **κ°€μ¤‘μΉλ§ μ „μ†΅**: μ›λ³Έ λ°μ΄ν„°λ‚ μ „μ²λ¦¬λ λ°μ΄ν„°λ” μ λ€ μ „μ†΅ν•μ§€ μ•μ
- **κΈ°μ—… κ°„ κ²©λ¦¬**: κ° κΈ°μ—…μ λ°μ΄ν„°λ” λ‹¤λ¥Έ κΈ°μ—…κ³Ό κ³µμ λμ§€ μ•μ

### μ—°ν•©ν•™μµ λΌμ΄λ“
1. **μ΄κΈ°ν™”**: μ„λ²„κ°€ μ΄κΈ° λ¨λΈ κ°€μ¤‘μΉλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ°°ν¬
2. **λ΅μ»¬ ν•™μµ**: κ° ν΄λΌμ΄μ–ΈνΈκ°€ μμ²΄ λ°μ΄ν„°λ΅ λ¨λΈ ν•™μµ
3. **κ°€μ¤‘μΉ μ—…λ΅λ“**: ν•™μµλ κ°€μ¤‘μΉλ¥Ό μ„λ²„λ΅ μ „μ†΅
4. **μ§‘κ³„**: μ„λ²„κ°€ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ κ°€μ¤‘μΉλ¥Ό ν‰κ· ν™”
5. **λ°°ν¬**: ν‰κ· ν™”λ κ°€μ¤‘μΉλ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ°°ν¬
6. **λ°λ³µ**: 2-5λ‹¨κ³„λ¥Ό λ°λ³µν•μ—¬ λ¨λΈ μ„±λ¥ ν–¥μƒ

## π® μ‚¬μ© λ°©λ²•

### 1. λ°μ΄ν„° μ¤€λΉ„

MongoDBμ—μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤:

```bash
python -m utils.dataset.download_labeled_layers --output data
```

λλ” Python μ½”λ“λ΅ μ‹¤ν–‰:

```python
from utils.dataset.download_labeled_layers import main as download_data
download_data()  # MongoDBμ—μ„ λ°μ΄ν„° λ‹¤μ΄λ΅λ“
```

### 2. λ°μ΄ν„° λ¶„μ„

λ°μ΄ν„°μ…‹μ κ²°ν•¨ μ ν•μ„ λ¶„μ„ν•©λ‹λ‹¤:

```bash
python -m utils.dataset.analyze_defect_types --data-dir data
```

λλ” Python μ½”λ“λ΅ μ‹¤ν–‰:

```python
from utils.dataset.analyze_defect_types import analyze_defect_dataset
analyze_defect_dataset(data_dir="data")
```

### 3. μ—°ν•©ν•™μµ μ‹¤ν–‰ (κ¶μ¥)

**λ…λ Ήμ¤„ μΈν„°νμ΄μ¤λ΅ μ‹¤ν–‰:**

```bash
# κΈ°λ³Έ μ„¤μ •μΌλ΅ μ‹¤ν–‰ (3κ° ν΄λΌμ΄μ–ΈνΈ, 3 λΌμ΄λ“)
python train_federated.py --data-dir data

# Non-IID μ •λ„ μ΅°μ  (λ§¤μ° νΈν–¥λ λ¶„ν¬)
python train_federated.py --data-dir data --non-iid-alpha 0.1

# λ” λ§μ€ λΌμ΄λ“μ™€ μ—ν­μΌλ΅ ν•™μµ
python train_federated.py --data-dir data --num-rounds 10 --epochs 3

# λ°°μΉ ν¬κΈ°μ™€ ν•™μµλ¥  μ΅°μ 
python train_federated.py --data-dir data --batch-size 64 --learning-rate 0.0001

# ResNet50 λ°±λ³Έ μ‚¬μ©
python train_federated.py --data-dir data --backbone resnet50

# GPU μ‚¬μ© (μλ™ κ°μ§€λμ§€λ§ λ…μ‹μ μΌλ΅ μ§€μ • κ°€λ¥)
python train_federated.py --data-dir data --device cuda
```

**μ£Όμ” μµμ…:**

| μµμ… | μ„¤λ… | κΈ°λ³Έκ°’ |
|------|------|--------|
| `--data-dir` | λ°μ΄ν„° λ””λ ‰ν† λ¦¬ κ²½λ΅ | `data` |
| `--num-clients` | ν΄λΌμ΄μ–ΈνΈ μ | `3` |
| `--non-iid-alpha` | Non-IID μ •λ„ (0.1: λ§¤μ° νΈν–¥, 0.5: λ³΄ν†µ, 10.0: κ· λ“±) | `0.5` |
| `--num-rounds` | μ—°ν•©ν•™μµ λΌμ΄λ“ μ | `3` |
| `--epochs` | κ° λΌμ΄λ“λ‹Ή λ΅μ»¬ ν•™μµ μ—ν­ μ | `1` |
| `--batch-size` | λ°°μΉ ν¬κΈ° | `32` |
| `--learning-rate` | ν•™μµλ¥  | `0.001` |
| `--backbone` | CNN λ°±λ³Έ λ¨λΈ (resnet18/resnet34/resnet50) | `resnet18` |
| `--server-port` | μ„λ²„ ν¬νΈ | `5000` |

**μ „μ²΄ μµμ… λ³΄κΈ°:**

```bash
python train_federated.py --help
```

### 4. Jupyter Notebook λ°λ¨ μ‹¤ν–‰

λ€ν™”ν• λ°λ¨λ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄:

```bash
jupyter notebook demo/federated_learning_demo.ipynb
```

λ°λ¨ λ…ΈνΈλ¶μ€ Non-IID λ°μ΄ν„° λ¶„λ°°λ¥Ό ν¬ν•¨ν• μ „μ²΄ νμ΄ν”„λΌμΈμ„ μ‹μ—°ν•©λ‹λ‹¤.

### 5. Python μ½”λ“λ΅ μ§μ ‘ μ‹¤ν–‰

ν”„λ΅κ·Έλλ° λ°©μ‹μΌλ΅ μ„Έλ°€ν• μ μ–΄κ°€ ν•„μ”ν• κ²½μ°:

```python
from pathlib import Path
from models.aprilgan import AprilGAN
from models.cnn import create_cnn_model
from federated.server import FederatedServer
from federated.client import FederatedClient
from utils.client_data_loader import load_client_data

# 1. AprilGAN μ΄κΈ°ν™”
aprilgan = AprilGAN()

# 2. Non-IID λ°μ΄ν„° λ΅λ“
train_loaders, val_loaders, defect_type_to_idx = load_client_data(
    data_dir=Path("data"),
    aprilgan_model=aprilgan,
    num_clients=3,
    non_iid_alpha=0.5,
    train_ratio=0.8,
    batch_size=32
)

# 3. λ¨λΈ μƒμ„±
num_classes = len(defect_type_to_idx)
cnn_model = create_cnn_model(num_classes=num_classes)

# 4. μ„λ²„ μ‹μ‘
server = FederatedServer(port=5000, num_clients=3, min_clients=2)
server.set_initial_weights(cnn_model.state_dict())
server.start()  # λ³„λ„ μ¤λ λ“μ—μ„ μ‹¤ν–‰

# 5. ν΄λΌμ΄μ–ΈνΈ μƒμ„± λ° ν•™μµ
clients = []
for client_id in range(3):
    client = FederatedClient(
        client_id=client_id,
        server_url='http://localhost:5000',
        model=cnn_model
    )
    clients.append(client)

# 6. μ—°ν•©ν•™μµ λΌμ΄λ“ μ‹¤ν–‰
for round_num in range(3):
    # κ°€μ¤‘μΉ μμ‹ 
    for client in clients:
        client.fetch_aggregated_weights(round_num)
    
    # λ΅μ»¬ ν•™μµ
    for client in clients:
        client.train_local(train_loaders[client.client_id], epochs=1)
    
    # κ°€μ¤‘μΉ μ—…λ΅λ“
    for client in clients:
        data_size = len(train_loaders[client.client_id].dataset)
        client.upload_weights(round_num, data_size)
```

## π“ λΉ λ¥Έ μ‹μ‘ κ°€μ΄λ“

### μ „μ²΄ νμ΄ν”„λΌμΈ μ‹¤ν–‰ (ν• μ¤„ λ…λ Ήμ–΄)

```bash
# 1. λ°μ΄ν„° μ¤€λΉ„ (MongoDBμ—μ„ λ‹¤μ΄λ΅λ“)
python -m utils.dataset.download_labeled_layers --output data

# 2. μ—°ν•©ν•™μµ μ‹¤ν–‰
python train_federated.py --data-dir data --num-rounds 5 --epochs 2
```

### λ‹¨κ³„λ³„ μ‹¤ν–‰

```bash
# 1λ‹¨κ³„: λ°μ΄ν„° λ‹¤μ΄λ΅λ“
python -m utils.dataset.download_labeled_layers --output data

# 2λ‹¨κ³„: λ°μ΄ν„° λ¶„μ„ (μ„ νƒμ‚¬ν•­)
python -m utils.dataset.analyze_defect_types --data-dir data

# 3λ‹¨κ³„: μ—°ν•©ν•™μµ μ‹¤ν–‰
python train_federated.py --data-dir data

# 4λ‹¨κ³„: κ²°κ³Ό ν™•μΈ
# ν•™μµ κ³Όμ •μ΄ μ½μ†”μ— μ‹¤μ‹κ°„μΌλ΅ μ¶λ ¥λ©λ‹λ‹¤
```

### ν•™μµ μµμ… μμ‹

```bash
# λ§¤μ° νΈν–¥λ Non-IID ν™κ²½μ—μ„ ν•™μµ
python train_federated.py --data-dir data --non-iid-alpha 0.1

# λ” λ§μ€ λΌμ΄λ“μ™€ μ—ν­μΌλ΅ ν•™μµ
python train_federated.py --data-dir data --num-rounds 10 --epochs 3

# ResNet50 λ°±λ³Έ μ‚¬μ©
python train_federated.py --data-dir data --backbone resnet50

# λ¨λ“  μµμ… λ³΄κΈ°
python train_federated.py --help
```

## π“ μ°Έκ³ λ¬Έν—

- λ…Όλ¬Έ 2: GAN κΈ°λ° ν•©μ„± λ°μ΄ν„° μƒμ„± λ°©λ²•λ΅ 
- λ² μ΄μ¤λΌμΈ: U-Net κΈ°λ° μ—°ν•© ν•™μµ κ²°ν•¨ λ¶„ν• 

---

## π“ λ¬Έμ„

- [μ„¤μΉ κ°€μ΄λ“](INSTALLATION.md) - ν™κ²½ μ„¤μ • λ° ν¨ν‚¤μ§€ μ„¤μΉ λ°©λ²•
- [μ”κµ¬μ‚¬ν•­](requirements.txt) - ν•„μ ν¨ν‚¤μ§€ λ©λ΅

---

**Last Updated**: 2025λ…„
